<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MongoDB: Concepts, Architecture & Usage ¬∑ Bida Platform</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&family=Merriweather:ital,wght@0,300;0,400;0,700;1,300&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="stylesheet" href="/css/theme.css">
    <style>
        :root {
            --mongo-green: #00ed64;
            --mongo-dark: #001e2b;
            --bg-dark: #020617;
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-bg: rgba(15, 23, 42, 0.6);
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
            --accent-blue: #3b82f6;
            --accent-purple: #8b5cf6;
            --accent-red: #ef4444;
            --accent-yellow: #f59e0b;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            color: var(--text-primary);
            line-height: 1.8;
            overflow-x: hidden;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 1.5rem 8rem;
        }

        /* --- Typography --- */
        h1,
        h2,
        h3,
        h4 {
            color: #fff;
            letter-spacing: -0.02em;
        }

        p {
            margin-bottom: 1.5rem;
            font-size: 1.05rem;
            color: #cbd5e1;
        }

        strong {
            color: #fff;
            font-weight: 600;
        }

        /* --- Header --- */
        .doc-header {
            text-align: center;
            padding: 8rem 1rem 5rem;
            position: relative;
        }

        .doc-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--mongo-green), transparent);
        }

        .badge {
            font-family: 'JetBrains Mono', monospace;
            color: var(--mongo-green);
            font-size: 0.75rem;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            padding: 0.6rem 1.2rem;
            border: 1px solid rgba(0, 237, 100, 0.2);
            border-radius: 50px;
            background: rgba(0, 237, 100, 0.05);
            display: inline-block;
            margin-bottom: 2rem;
            box-shadow: 0 0 20px rgba(0, 237, 100, 0.1);
        }

        .doc-title {
            font-size: 3.5rem;
            font-weight: 800;
            line-height: 1.1;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, #fff 30%, #94a3b8 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .doc-subtitle {
            font-size: 1.25rem;
            line-height: 1.6;
            color: var(--text-secondary);
            font-weight: 300;
            max-width: 700px;
            margin: 0 auto;
        }

        /* --- Navigation Pill --- */
        .nav-wrapper {
            position: sticky;
            top: 2rem;
            z-index: 100;
            display: flex;
            justify-content: center;
            margin-bottom: 4rem;
            pointer-events: none;
        }

        .doc-nav {
            pointer-events: auto;
            background: rgba(15, 23, 42, 0.85);
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(16px);
            padding: 0.5rem;
            border-radius: 99px;
            display: flex;
            gap: 0.25rem;
            box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.5);
        }

        .nav-link {
            color: var(--text-secondary);
            text-decoration: none;
            padding: 0.6rem 1.25rem;
            border-radius: 99px;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            color: #fff;
            background: rgba(255, 255, 255, 0.05);
        }

        .nav-link.active {
            background: var(--mongo-green);
            color: #000;
            font-weight: 600;
            box-shadow: 0 0 20px rgba(0, 237, 100, 0.3);
        }

        /* --- Sections & Cards --- */
        .section {
            margin-bottom: 4rem;
            scroll-margin-top: 8rem;
        }

        .section-header {
            display: flex;
            align-items: baseline;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 1px solid var(--glass-border);
            padding-bottom: 1rem;
        }

        .section-num {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            color: var(--mongo-green);
            opacity: 0.8;
            font-weight: 700;
        }

        .section h2 {
            font-size: 2rem;
            font-weight: 700;
        }

        .card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 2.5rem;
            backdrop-filter: blur(12px);
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .card h3 {
            font-size: 1.4rem;
            margin: 2.5rem 0 1rem;
            padding-left: 1rem;
            border-left: 3px solid var(--mongo-green);
        }

        .card h3:first-of-type {
            margin-top: 0;
        }

        .card h4 {
            font-size: 1.1rem;
            margin: 1.5rem 0 0.75rem;
            color: var(--text-primary);
        }

        /* --- Components --- */
        .comparison-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 2rem 0;
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            overflow: hidden;
            font-size: 0.95rem;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 1.25rem;
            text-align: left;
            border-bottom: 1px solid var(--glass-border);
        }

        .comparison-table th {
            background: rgba(255, 255, 255, 0.05);
            color: #fff;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 0.05em;
        }

        .comparison-table tr:last-child td {
            border-bottom: none;
        }

        .comparison-table td {
            background: rgba(0, 0, 0, 0.2);
        }

        .code-block {
            background: #0d1117;
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            padding: 1.5rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.6;
            overflow-x: auto;
            margin: 1.5rem 0;
            color: #e6edf3;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }

        .info-box {
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 4px solid;
            background: rgba(255, 255, 255, 0.03);
            margin: 1.5rem 0;
        }

        .info-box.tip {
            border-color: var(--mongo-green);
            background: rgba(0, 237, 100, 0.05);
        }

        .info-box.warn {
            border-color: var(--accent-yellow);
            background: rgba(245, 158, 11, 0.05);
        }

        .info-box.crit {
            border-color: var(--accent-red);
            background: rgba(239, 68, 68, 0.05);
        }

        .feature-list li {
            position: relative;
            padding-left: 1.5rem;
            margin-bottom: 0.5rem;
            list-style: none;
            color: var(--text-primary);
        }

        .feature-list li::before {
            content: "‚Ä¢";
            color: var(--mongo-green);
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        /* --- Visualizers --- */
        .tree-viz {
            font-family: 'JetBrains Mono', monospace;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            color: var(--text-secondary);
        }

        .tree-node {
            margin-left: 20px;
            position: relative;
        }

        .tree-node::before {
            content: '‚îî‚îÄ‚îÄ';
            position: absolute;
            left: -20px;
            color: var(--glass-border);
        }

        .tree-root {
            font-weight: bold;
            color: #fff;
        }

        /* --- Diagram / CAP Visual --- */
        .cap-triangle {
            width: 200px;
            height: 180px;
            margin: 2rem auto;
            position: relative;
        }

        .cap-point {
            position: absolute;
            width: 80px;
            text-align: center;
            font-weight: bold;
            font-size: 0.8rem;
            background: rgba(255, 255, 255, 0.1);
            padding: 0.5rem;
            border-radius: 4px;
        }

        .cap-c {
            top: 0;
            left: 60px;
            color: var(--mongo-green);
            border: 1px solid var(--mongo-green);
        }

        .cap-a {
            bottom: 0;
            left: 0;
            color: var(--text-secondary);
            opacity: 0.5;
        }

        .cap-p {
            bottom: 0;
            right: 0;
            color: var(--mongo-green);
            border: 1px solid var(--mongo-green);
        }

        .cap-label {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
            color: #fff;
        }

        /* --- Syntax Highlighting --- */
        .k {
            color: #ff7b72;
        }

        .s {
            color: #a5d6ff;
        }

        .n {
            color: #79c0ff;
        }

        .f {
            color: #d2a8ff;
        }

        .c {
            color: #8b949e;
            font-style: italic;
        }

        /* --- Back Button --- */
        .home-btn {
            position: fixed;
            top: 2rem;
            left: 2rem;
            text-decoration: none;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(8px);
            font-size: 0.9rem;
            z-index: 200;
            transition: all 0.2s;
        }

        .home-btn:hover {
            color: #fff;
            border-color: var(--mongo-green);
        }

        @media (max-width: 900px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }

            .nav-wrapper {
                display: none;
            }
        }
    </style>
</head>

<body>
    <!-- Unified Background -->
    <div class="ambient-orb orb-1"></div>
    <div class="ambient-orb orb-2"></div>
    <div class="ambient-orb orb-3"></div>
    <canvas id="particle-canvas"></canvas>

    <a href="/" class="home-btn">‚Üê Query Lab</a>

    <div class="container animate__animated animate__fadeIn">

        <header class="doc-header">
            <div class="badge">Docs v7.0</div>
            <h1 class="doc-title">MongoDB: Concepts, Architecture & Usage</h1>
            <p class="doc-subtitle">A rigorous, end-to-end explanation of MongoDB as a modern NoSQL database system
                covering theoretical foundations, internal architecture, and real-world usage.</p>
        </header>

        <div class="nav-wrapper animate__animated animate__fadeInUp animate__delay-1s">
            <nav class="doc-nav">
                <a href="#philosophy" class="nav-link">Philosophy</a>
                <a href="#bson" class="nav-link">BSON</a>
                <a href="#schema" class="nav-link">Schema</a>
                <a href="#crud" class="nav-link">CRUD</a>
                <a href="#internals" class="nav-link">Internals</a>
                <a href="#distributed" class="nav-link">Distributed</a>
            </nav>
        </div>

        <!-- 1. Philosophy -->
        <section id="philosophy" class="section">
            <div class="section-header">
                <span class="section-num">01</span>
                <h2>Philosophy & The NoSQL Paradigm</h2>
            </div>
            <div class="card">
                <h3>Limits of Relational Databases</h3>
                <p>Relational databases (RDBMS) face limitations at modern scale, primarily due to rigid schemas
                    (expensive <code>ALTER TABLE</code>) and the difficulty of horizontal scaling (sharding complexity).
                </p>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Aspect</th>
                            <th>SQL (Relational)</th>
                            <th>MongoDB (Document)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Schema</strong></td>
                            <td>Fixed, enforced on write</td>
                            <td>Flexible, polymorphic</td>
                        </tr>
                        <tr>
                            <td><strong>Data Model</strong></td>
                            <td>Tables, Rows, Foreign Keys</td>
                            <td>Collections, Documents, Embedded Arrays</td>
                        </tr>
                        <tr>
                            <td><strong>Scaling</strong></td>
                            <td>Vertical (Scale Up)</td>
                            <td>Horizontal (Sharding)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- 2. BSON -->
        <section id="bson" class="section">
            <div class="section-header">
                <span class="section-num">02</span>
                <h2>BSON: The Data Format</h2>
            </div>
            <div class="card">
                <h3>Why BSON?</h3>
                <p>MongoDB uses <strong>BSON (Binary JSON)</strong>. It adds types like <code>Date</code>,
                    <code>ObjectId</code>, and <code>Decimal128</code> which plain JSON lacks, and is optimized for
                    traversal speed.
                </p>
                <div class="code-block">
                    {
                    <span class="k">"_id"</span>: <span class="f">ObjectId</span>(<span class="s">"..."</span>),
                    <span class="k">"price"</span>: <span class="f">Decimal128</span>(<span class="s">"19.99"</span>),
                    <span class="k">"created"</span>: <span class="f">ISODate</span>(<span
                        class="s">"2025-01-01"</span>)
                    }
                </div>
            </div>
        </section>

        <!-- 3. Schema -->
        <section id="schema" class="section">
            <div class="section-header">
                <span class="section-num">03</span>
                <h2>Data Modeling & Schema Design</h2>
            </div>
            <div class="card">
                <h3>Embedding vs Referencing</h3>
                <div class="grid-2">
                    <div>
                        <h4>Strategy A: Embedding</h4>
                        <p>Store related data <strong>inside</strong> the document. Best for "One-to-Few". Fast reads.
                        </p>
                    </div>
                    <div>
                        <h4>Strategy B: Referencing</h4>
                        <p>Store relations by ID. Best for "One-to-Many" or "Many-to-Many". Reduces duplication.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 4. CRUD -->
        <section id="crud" class="section">
            <div class="section-header">
                <span class="section-num">04</span>
                <h2>CRUD Operations</h2>
            </div>
            <div class="card">
                <h3>Read (Find)</h3>
                <div class="code-block">
                    db.users.<span class="f">find</span>(
                    { <span class="k">"age"</span>: { <span class="k">"$gt"</span>: <span class="n">18</span> } },
                    { <span class="k">"name"</span>: <span class="n">1</span> }
                    )
                </div>
                <h3>Atomic Updates</h3>
                <div class="code-block">
                    db.products.<span class="f">updateOne</span>(
                    { <span class="k">"_id"</span>: <span class="n">100</span> },
                    { <span class="k">"$inc"</span>: { <span class="k">"stock"</span>: <span class="n">-1</span> } }
                    )
                </div>
            </div>
        </section>

        <!-- 5. FUNDAMENTALS: Internals -->
        <section id="internals" class="section">
            <div class="section-header">
                <span class="section-num">05</span>
                <h2>Under the Hood: Engineering Internals</h2>
            </div>

            <div class="card">
                <h3>Storage Engine: WiredTiger</h3>
                <p>Since version 3.2, MongoDB uses <strong>WiredTiger</strong> as its default storage engine. It
                    provides:</p>
                <ul class="feature-list">
                    <li><strong>Document-Level Concurrency:</strong> Unlike older engines which had collection-level
                        locks, WiredTiger allows multiple threads to modify different documents simultaneously.</li>
                    <li><strong>Compression:</strong> Uses block compression (Snappy) to reduce disk usage and I/O.</li>
                    <li><strong>Journaling (WAL):</strong> Writes to a Write-Ahead Log first to ensure durability.</li>
                    <li><strong>Checkpointing:</strong> Regularly flushes data to disk every 60 seconds or 2GB of data.
                    </li>
                </ul>

                <h3 style="margin-top:2.5rem">Indexing Implementation (B-Trees)</h3>
                <p>MongoDB indexes are implemented as <strong>B-Trees</strong>. This balanced tree structure allows
                    finding documents in <code>O(log n)</code> time.</p>

                <div class="info-box tip">
                    <strong>Compound Indexes:</strong> The order matters. An index on
                    <code>{ "last": 1, "first": 1 }</code> supports queries on <code>last</code> but not on
                    <code>first</code> alone.
                </div>
            </div>

            <div class="card">
                <h3>Transactions & Consistency</h3>
                <p>MongoDB supports <strong>Multi-Document ACID Transactions</strong> since v4.0. This allows for
                    complex operations across multiple collections with snapshot isolation.</p>
                <div class="code-block">
                    <span class="c">// Multi-document transaction example</span>
                    <span class="k">const</span> session = db.<span class="f">getMongo</span>().<span
                        class="f">startSession</span>();
                    session.<span class="f">startTransaction</span>();
                    <span class="k">try</span> {
                    db.accounts.<span class="f">updateOne</span>({ _id: <span class="s">"A"</span> }, { <span
                        class="k">$inc</span>: { balance: <span class="n">-100</span> } });
                    db.accounts.<span class="f">updateOne</span>({ _id: <span class="s">"B"</span> }, { <span
                        class="k">$inc</span>: { balance: <span class="n">100</span> } });
                    session.<span class="f">commitTransaction</span>();
                    } <span class="k">catch</span> (e) {
                    session.<span class="f">abortTransaction</span>();
                    }
                </div>
            </div>
        </section>

        <!-- 6. FUNDAMENTALS: Distributed Systems -->
        <section id="distributed" class="section">
            <div class="section-header">
                <span class="section-num">06</span>
                <h2>Distributed Systems Theory</h2>
            </div>

            <div class="card">
                <h3>CAP Theorem Positioning</h3>
                <div class="grid-2">
                    <div>
                        <p>MongoDB is a <strong>CP System</strong> (Consistent & Partition Tolerant). It chooses
                            Consistency over Availability during a network partition.</p>
                        <p><strong>PACELC:</strong> Extends CAP. "If Partition (P), choose Consistency (C) vs
                            Availability (A); Else (E), choose Latency (L) vs Consistency (C)."</p>
                    </div>
                    <div class="cap-triangle">
                        <div class="cap-point cap-c">Consistency</div>
                        <div class="cap-point cap-a">Availability</div>
                        <div class="cap-point cap-p">Partition</div>
                        <div class="cap-label">CP</div>
                    </div>
                </div>

                <h3>Interactive Simulator: Write Concern</h3>
                <p>Visualize how write acknowledgments work across a 3-node replica set.</p>

                <div class="info-box" style="background: rgba(0,0,0,0.3); border: 1px solid var(--glass-border);">
                    <div id="wc-viz"
                        style="display: flex; justify-content: space-around; align-items: center; padding: 1rem;">
                        <div class="node primary"
                            style="padding: 1rem; border: 2px solid var(--mongo-green); border-radius: 8px; text-align: center;">
                            <div style="font-size: 0.7rem; color: var(--text-secondary);">PRIMARY</div>
                            <div id="node-p-status" style="font-size: 1.2rem;">üü¢</div>
                        </div>
                        <div class="node secondary"
                            style="padding: 1rem; border: 2px solid var(--text-secondary); border-radius: 8px; text-align: center;">
                            <div style="font-size: 0.7rem; color: var(--text-secondary);">SEC-1</div>
                            <div id="node-s1-status" style="font-size: 1.2rem;">‚ö™</div>
                        </div>
                        <div class="node secondary"
                            style="padding: 1rem; border: 2px solid var(--text-secondary); border-radius: 8px; text-align: center;">
                            <div style="font-size: 0.7rem; color: var(--text-secondary);">SEC-2</div>
                            <div id="node-s2-status" style="font-size: 1.2rem;">‚ö™</div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 1rem; margin-top: 1rem; justify-content: center;">
                        <button onclick="simulateWrite(1)" class="nav-link"
                            style="background: rgba(255,255,255,0.05); cursor: pointer; border: 1px solid var(--glass-border);">w:
                            1</button>
                        <button onclick="simulateWrite('majority')" class="nav-link"
                            style="background: rgba(255,255,255,0.05); cursor: pointer; border: 1px solid var(--glass-border);">w:
                            majority</button>
                    </div>
                    <div id="wc-log"
                        style="text-align: center; margin-top: 1rem; font-family: monospace; font-size: 0.8rem; color: var(--mongo-green);">
                        Waiting for write command...</div>
                </div>
            </div>

            <div class="card">
                <h3>Replication & Sharding</h3>
                <ul class="feature-list">
                    <li><strong>Replica Sets:</strong> High availability through automatic failover via elections.</li>
                    <li><strong>Sharding:</strong> Horizontal scaling by partitioning data using a <strong>Shard
                            Key</strong>. Design of shard keys is critical to prevent "jumbo shards".</li>
                </ul>
            </div>
        </section>

        <!-- 7. Security & Real World -->
        <section id="security" class="section">
            <div class="section-header">
                <span class="section-num">07</span>
                <h2>Security & Ecosystem</h2>
            </div>

            <div class="card">
                <h3>Security Fundamentals</h3>
                <div class="grid-2">
                    <div>
                        <h4>RBAC (Role-Based Access Control)</h4>
                        <p>User permissions are defined by roles (e.g., <code>readWrite</code>, <code>dbAdmin</code>).
                            Avoid the "Root" user for applications.</p>
                    </div>
                    <div>
                        <h4>Network & Encryption</h4>
                        <p>TLS/SSL for data in transit. Encryption-at-Rest for data on disk. Client-Side Field Level
                            Encryption (CSFLE) for sensitive data.</p>
                    </div>
                </div>

                <h3>The Tooling Ecosystem</h3>
                <div class="feature-grid">
                    <div class="feature-item">
                        <strong>mongosh</strong>
                        <p style="font-size: 0.85rem">Modern terminal shell with JS support.</p>
                    </div>
                    <div class="feature-item">
                        <strong>Compass</strong>
                        <p style="font-size: 0.85rem">GUI tool for visualizing schema and querying.</p>
                    </div>
                    <div class="feature-item">
                        <strong>Atlas</strong>
                        <p style="font-size: 0.85rem">Managed DB-as-a-Service cloud platform.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 8. Common Misconceptions -->
        <section class="section">
            <div class="section-header">
                <span class="section-num">08</span>
                <h2>Common Misconceptions</h2>
            </div>
            <div class="card" style="border-top: 4px solid var(--accent-yellow)">
                <div class="grid-2">
                    <div>
                        <h4>"No Schema = No Design"</h4>
                        <p><strong>Fact:</strong> Schema design in NoSQL is <em>more</em> critical because you design
                            for <strong>Access Patterns</strong>, not just relationships.</p>
                    </div>
                    <div>
                        <h4>"MongoDB is always faster"</h4>
                        <p><strong>Fact:</strong> It is faster for <em>specific</em> workloads (e.g., large reads of
                            embedded data). Join-heavy workloads can be slower.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 9. Evaluation -->
        <section class="section">
            <div class="section-header">
                <span class="section-num">09</span>
                <h2>Evaluation & Closing</h2>
            </div>
            <div class="card" style="border-left: 4px solid var(--accent-blue)">
                <p>MongoDB trades off the relational logic of SQL for <strong>Developer Productivity</strong> and
                    <strong>Operational Scale</strong>.
                </p>
                <p style="margin-top: 1rem; font-style: italic; color: #fff;">
                    "MongoDB is not a replacement for relational databases. It is a different tool optimized for
                    different constraints. Correct usage depends on understanding its internal model, not just its
                    syntax."
                </p>
            </div>
        </section>

    </div>

    <!-- Active Link & Simulator Script -->
    <script>
        // Nav Highlighting
        const sections = document.querySelectorAll('section');
        const navLinks = document.querySelectorAll('.nav-link');
        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (scrollY >= (sectionTop - 300)) { current = section.getAttribute('id'); }
            });
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href').includes(current)) { link.classList.add('active'); }
            });
        });

        // Write Concern Simulator
        function simulateWrite(wc) {
            const log = document.getElementById('wc-log');
            const p = document.getElementById('node-p-status');
            const s1 = document.getElementById('node-s1-status');
            const s2 = document.getElementById('node-s2-status');

            // Reset
            p.innerText = 'üü¢'; s1.innerText = '‚ö™'; s2.innerText = '‚ö™';
            log.innerText = "Command sent to Primary...";

            setTimeout(() => {
                p.innerText = '‚ú®';
                log.innerText = "Primary acknowledged write.";
                if (wc == 1) {
                    log.innerText += " (w:1 Satisfied)";
                } else {
                    log.innerText = "Replicating to secondaries...";
                    setTimeout(() => {
                        s1.innerText = 'üü¢';
                        log.innerText = "SEC-1 acknowledged. Total: 2/3 (Majority Satisfied)";
                        setTimeout(() => {
                            s2.innerText = 'üü¢';
                            log.innerText = "SEC-2 acknowledged. Fully Replicated.";
                        }, 800);
                    }, 800);
                }
            }, 800);
        }
    </script>
    <script src="/js/background.js"></script>
</body>

</html>